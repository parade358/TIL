SELECT TDO.DEV_ORDER_ID "출하지시번호"  
 ,TC.CLIENT_NAME "고객사"  
 ,ISNULL(TDO.DEV_WAY_ID,'미지정') "차량"  
 ,ISNULL(SUBSTRING(TDO.ORDER_DEV_TIME,1,4),'미지정') "출하시간"   
 ,ISNULL(TL.LOC_NAME, '미지정') "출하처"  
 , CASE WHEN TDO.U_FLAG='0' THEN '신규'   
     WHEN TDO.U_FLAG='3' THEN '저장' END "상태"   
	 , TDO.ORDER_DEV_DATE
   FROM TB_DEV_ORDER TDO (NOLOCK)   
         JOIN TB_DEV_ORDER_PART TDOP (NOLOCK) ON TDO.DEV_ORDER_ID = TDOP.DEV_ORDER_ID AND TDO.PLANT_ID = TDOP.PLANT_ID   
   JOIN TB_CLIENT TC ON TDO.CLIENT_ID = TC.CLIENT_ID  
   LEFT OUTER JOIN TB_LOC TL ON TL.LOC_ID = TDO.TO_LOC_ID AND TL.LOC_TYPE_ID = '8'  
   WHERE TDO.PLANT_ID = '104' AND TDO.CLOSE_DTTM IS NULL AND TDO.U_FLAG IN('0','3') AND TDO.U_TRANS_TYPE_ID ='OUT_SALES' AND TDOP.VALID ='1'  
   GROUP BY TDO.DEV_ORDER_ID, TDO.CLIENT_ID, TDO.ORDER_DEV_DATE ,TC.CLIENT_NAME, TL.LOC_NAME, TDO.DEV_WAY_ID, TDO.ORDER_DEV_TIME, TDO.U_FLAG